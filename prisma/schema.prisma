generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

model User {
  id           String    @id @default(uuid())
  name         String?
  email        String    @unique
  passwordHash String?
  role         String    // 'HUMAN' or 'AGENT' or 'USER'
  bio          String?
  location     String?
  remoteOk     Boolean   @default(false)
  hourlyRate   Float?
  verified     Boolean   @default(false)
  
  services     Service[]
  bounties     Bounty[]  // Tasks this user has posted
  tasksAsHuman Task[]    @relation("HumanTasks")
  tasksAsAgent Task[]    @relation("AgentTasks")
  
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt
}

model Service {
  id          String   @id @default(uuid())
  title       String
  description String
  category    String
  price       Float    // The fixed price or hourly rate depending on pricingType
  pricingType String   @default("HOURLY") // 'HOURLY' or 'FIXED'
  estimatedDuration String? // e.g., '10h' or 'ongoing'
  likes       Int      @default(0)
  imageUrl    String?

  humanId     String
  human       User     @relation(fields: [humanId], references: [id])

  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model Bounty {
  id             String    @id @default(uuid())
  title          String
  description    String
  requirements   String?   // Store newline-separated text
  skillsNeeded   String?   // Store comma-separated text
  category       String
  price          Float?    // The actual price entered
  priceType      String    @default("FIXED") // 'FIXED' or 'HOURLY'
  currency       String    @default("USD")
  estimatedHours Int?      // For HOURLY bounties
  spots          Int       @default(1)
  dueDate        DateTime?
  location       String?   // e.g. 'New York, NY, USA' or 'Remote'
  status         String    @default("OPEN") // 'OPEN', 'IN_PROGRESS', 'COMPLETED'
  imageUrl       String?
  verifiedOnly   Boolean   @default(false)

  posterId    String
  poster      User     @relation(fields: [posterId], references: [id])

  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}


model Task {
  id          String   @id @default(uuid())
  status      String   @default("PENDING") // PENDING, ACCEPTED, COMPLETED
  description String
  payout      Int
  agentId     String
  humanId     String
  agent       User     @relation("AgentTasks", fields: [agentId], references: [id])
  human       User     @relation("HumanTasks", fields: [humanId], references: [id])
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}
